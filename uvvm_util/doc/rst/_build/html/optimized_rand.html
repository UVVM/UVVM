

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Optimized Randomization &mdash; General Randomization and Functional Coverage 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Types" href="func_cov_pkg_types.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #F5F5F5" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/uvvm.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="rand_pkg_overview.html">General Randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="func_cov_pkg_overview.html">Functional Coverage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Optimized Randomization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#randomization-weights">Randomization weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="#randomization-using-transitions">Randomization using transitions</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">General Randomization and Functional Coverage</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Optimized Randomization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/optimized_rand.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="optimized-randomization">
<span id="id1"></span><h1>Optimized Randomization<a class="headerlink" href="#optimized-randomization" title="Permalink to this headline">¶</a></h1>
<p>Using General Randomization can be somewhat inefficient when trying to randomize several sets of values, especially with large
and small ranges. Since the values in the large ranges will be generated more times than the ones in the small ranges in a Uniform
distribution, this will cause the simulation to run longer in order to cover all the valid bins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before using Optimized Randomization, it is recommended to have a look at <a class="reference internal" href="func_cov_pkg_overview.html#func-cov-pkg-overview"><span class="std std-ref">Functional Coverage</span></a> to be familiar with the
basic concepts.</p>
</div>
<p>By using Optimized Randomization, random values can be generated by using only the uncovered bins, thus reducing simulation time.
Once all the bins have been covered, random values are generated again using all the valid bins.</p>
<ul class="simple">
<li><p>The randomization seeds are initialized with the unique default name of the coverpoint.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">rand()</span></code> function does not need any parameters as it is constrained by the bins.</p></li>
</ul>
<p>In the following examples all the bins have <em>min_hits=1</em>, meaning that after being sampled once they stop being selected for
randomization (until all bins are covered).</p>
<div class="highlight-VHDL notranslate"><div class="highlight"><pre><span></span><span class="c1">-- Example 1: The loop will iterate 100 times to generate random values from the 100 different bins</span>
<span class="c1">-- Randomization sequence example: 64,42,35,7,89,92,...</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">));</span>
<span class="k">while</span> <span class="k">not</span><span class="p">(</span><span class="n">my_coverpoint</span><span class="p">.</span><span class="n">coverage_completed</span><span class="p">(</span><span class="n">BINS_AND_HITS</span><span class="p">))</span> <span class="k">loop</span>
  <span class="n">my_addr</span> <span class="o">:=</span> <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">VOID</span><span class="p">);</span>
  <span class="k">wait</span> <span class="k">for</span> <span class="n">C_CLK_PERIOD</span><span class="p">;</span>
  <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="n">my_addr</span><span class="p">);</span>
<span class="k">end</span> <span class="k">loop</span><span class="p">;</span>

<span class="c1">-- Example 2: The loop will iterate 4 times to generate random values from the 4 different bins. Only a single random</span>
<span class="c1">-- value from the range bin will be selected, same applies for the bin with multiple values.</span>
<span class="c1">-- Randomization sequence example: 3,7,0,30</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin_range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">)));</span>
<span class="k">while</span> <span class="k">not</span><span class="p">(</span><span class="n">my_coverpoint</span><span class="p">.</span><span class="n">coverage_completed</span><span class="p">(</span><span class="n">BINS_AND_HITS</span><span class="p">))</span> <span class="k">loop</span>
  <span class="n">my_addr</span> <span class="o">:=</span> <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">VOID</span><span class="p">);</span>
  <span class="k">wait</span> <span class="k">for</span> <span class="n">C_CLK_PERIOD</span><span class="p">;</span>
  <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="n">my_addr</span><span class="p">);</span>
<span class="k">end</span> <span class="k">loop</span><span class="p">;</span>

<span class="c1">-- Example 3: The loop will iterate 6 times to generate random values from the 3 different bins. When the rand() function</span>
<span class="c1">-- selects a transition bin, the next value selected by rand() will be the next transition value in the bin, and so on</span>
<span class="c1">-- until the all the values in the bin are generated.</span>
<span class="c1">-- Randomization sequence example: 2,4,6,8,0,3</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin_transition</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)));</span>
<span class="k">while</span> <span class="k">not</span><span class="p">(</span><span class="n">my_coverpoint</span><span class="p">.</span><span class="n">coverage_completed</span><span class="p">(</span><span class="n">BINS_AND_HITS</span><span class="p">))</span> <span class="k">loop</span>
  <span class="n">my_addr</span> <span class="o">:=</span> <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">VOID</span><span class="p">);</span>
  <span class="k">wait</span> <span class="k">for</span> <span class="n">C_CLK_PERIOD</span><span class="p">;</span>
  <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="n">my_addr</span><span class="p">);</span>
<span class="k">end</span> <span class="k">loop</span><span class="p">;</span>

<span class="c1">-- Example 4: After the 4 bin values are generated by the rand() function and sampled, any bin can be selected again for</span>
<span class="c1">-- generating random values.</span>
<span class="c1">-- Randomization sequence example: 5,1,3,7,1,1,7,3,5,7</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">7</span><span class="p">));</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span> <span class="k">to</span> <span class="mi">10</span> <span class="k">loop</span>
  <span class="n">my_addr</span> <span class="o">:=</span> <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">VOID</span><span class="p">);</span>
  <span class="k">wait</span> <span class="k">for</span> <span class="n">C_CLK_PERIOD</span><span class="p">;</span>
  <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="n">my_addr</span><span class="p">);</span>
<span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Ignore and illegal bins will never be selected for randomization. However, if an illegal or ignore bin contains overlapping
values with a valid bin, they might be generated as there is no check to avoid this.</p>
</div>
<div class="section" id="randomization-weights">
<h2>Randomization weights<a class="headerlink" href="#randomization-weights" title="Permalink to this headline">¶</a></h2>
<p>The parameter <em>rand_weight</em> in the <code class="docutils literal notranslate"><span class="pre">add_bins()</span></code> procedure specifies the relative number of times a bin will be selected during
randomization. It is not applicable for ignore or illegal bins since they are never selected for randomization.</p>
<div class="highlight-VHDL notranslate"><div class="highlight"><pre><span></span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">,</span> <span class="n">min_hits</span><span class="p">,</span> <span class="n">rand_weight</span><span class="p">,</span> <span class="p">[</span><span class="n">bin_name</span><span class="p">])</span>

<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">-- Selected 10% of the time</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">-- Selected 30% of the time</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span> <span class="c1">-- Selected 60% of the time</span>
</pre></div>
</div>
<p>If a randomization weight is not specified, the bin will have a default weight equal to the minimum coverage. Moreover, this weight
will be reduced by 1 every time the bin is sampled, thus balancing the randomization of the bins in an “adaptive” way. When all the
bins have been covered, their respective randomization weights will be reset to their default value equal to the minimum coverage
and will not change.</p>
<div class="highlight-VHDL notranslate"><div class="highlight"><pre><span></span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">,</span> <span class="n">min_hits</span><span class="p">,</span> <span class="p">[</span><span class="n">bin_name</span><span class="p">])</span>

<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">-- Selected 50% of the time (rand_weight = min_hits = 10)</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">5</span><span class="p">);</span>  <span class="c1">-- Selected 25% of the time (rand_weight = min_hits = 5)</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">5</span><span class="p">);</span>  <span class="c1">-- Selected 25% of the time (rand_weight = min_hits = 5)</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>   <span class="c1">-- bin(0) will now be selected 47% of the time (rand_weight = 9)</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>   <span class="c1">-- bin(0) will now be selected 44% of the time (rand_weight = 8)</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>   <span class="c1">-- bin(0) will now be selected 41% of the time (rand_weight = 7)</span>
</pre></div>
</div>
</div>
<div class="section" id="randomization-using-transitions">
<h2>Randomization using transitions<a class="headerlink" href="#randomization-using-transitions" title="Permalink to this headline">¶</a></h2>
<p>The Optimized Randomization mechanism will always select random values among the bins. In the case of a transition bin, when it is
selected for randomization, it will return each value of the bin in sequence until the complete transition is generated, this
ensures that the complete sequence can be randomly generated. However, if we also want to generate random transitions which are
not included in the transition bins, we can use a range bin:</p>
<div class="highlight-VHDL notranslate"><div class="highlight"><pre><span></span><span class="c1">-- The range bin will generate random values in the range [1:20]. Note that it has a min_hits value of 9 since the bin</span>
<span class="c1">-- values overlap with those of the transition bins, therefore if a transition bin is sampled, the range bin will also</span>
<span class="c1">-- be sampled.</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin_transition</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin_transition</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">my_coverpoint</span><span class="p">.</span><span class="n">add_bins</span><span class="p">(</span><span class="n">bin_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mi">9</span><span class="p">);</span>

<span class="k">while</span> <span class="k">not</span><span class="p">(</span><span class="n">my_coverpoint</span><span class="p">.</span><span class="n">coverage_completed</span><span class="p">(</span><span class="n">BINS_AND_HITS</span><span class="p">))</span> <span class="k">loop</span>
  <span class="n">my_addr</span> <span class="o">:=</span> <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">VOID</span><span class="p">);</span>
  <span class="k">wait</span> <span class="k">for</span> <span class="n">C_CLK_PERIOD</span><span class="p">;</span>
  <span class="n">my_coverpoint</span><span class="p">.</span><span class="n">sample_coverage</span><span class="p">(</span><span class="n">my_addr</span><span class="p">);</span>
<span class="k">end</span> <span class="k">loop</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="func_cov_pkg_types.html" class="btn btn-neutral float-left" title="Types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, UVVM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    
  <style>
         .wy-nav-content { max-width: 975px; }
  </style>


</body>
</html>